sudo: true

language: cpp

matrix:
  include:
    - os: linux
      dist: xenial
      python: "3.7"
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-8
            - pkg-config
            - uuid-dev
      env:
        - EVAL="CC=gcc-8 && CXX=g++-8"
        - OSNAME="linux"
    - os: osx
      osx_image: xcode10.2
      python: "3.7"
      env:
        - EVAL=""
        - OSNAME="mac"

before_install:
  - eval "${EVAL}"

script:
  - make prod
  - make test
  - make deploy

deploy:
  provider: releases
  api_key:
    secure: eBJFFOxAX4bWknl7VeT+JKQMCvfb4VDBMsYZlnwIVfs/RAdMXFdOcz2qGGfvi8pQFEvVTRkUTV9qfWcI5RIEnzNhBuhI7tzt/JvrZuzFUDNHkqzUoGzB+tb+Oyc7M9WNua27EnKYypMHiPhOJOInndxQXRx8vWRntPu1LPgstMG2dbfedqpoTva2qveuq623mlabw4o20xvD2fiwRMF9N3Ox+OobcrATePXi7ZwnXvOlJr4/ikjbiBiuB1GRPZYLa6Da9sTvAJJUVYB1itDq/yKddaPaf4J9dziUn4NX9Vj3X7KCg/SvB2UfcMDwmaiZ2YzcAYXEC96VENlnKh+JN+AsJz127SOr94lF922+adjEk50u5/HfT4p+1aBjyAMQrQvzWtKcdmLoQRcxkhEwnd8EpMUBf+yUkRHNAUncy8TkqLB/wiMyl0v5xhxxZnpqYALKWnXtcgUC4OMxgtHuP3UMxUE0dNvh7oSPou3buhGCHqX1Bkc+G+LQVasbvLob80EgH7knla1p6MG1dJIbP1gWmqRpgMwnasxK/OUPFsowuzkn5fnLczhs/MLhTpBsDiZ7BmKtw6lfiRNFxHvQ8BmvBmAIntFJp7W7vf6uClgcp0hl0IYm/dIfP7JsIGcoxEubOsdC7vv4WfouNadfps2KObL/GOGfrb4P8/SFmew=
  file: "${OSNAME}.zip"
  skip_cleanup: true
  on:
    tags: true
